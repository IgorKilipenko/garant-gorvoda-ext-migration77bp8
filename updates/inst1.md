# Выгрузка

ИЗМ. Группы потребителей:

Ж. дома с водопр.и кан.и ван. с газ. водонагр.__1
Ж. дома с водопр.и кан.и ван. с газ. водонагр.__2
Ж. дома с водопр.и кан.и ван. с газ. водонагр.__3

Ж. дома с центр. гор. водоснбж. (у,м,д,в)__1
Ж. дома с центр. гор. водоснбж. (у,м,д,в)__2

1. Счетчики
Обработка выполнена.
Выгружено 9765 объектов.
ГП_Счетчики.xml

2. Показания всех счетчиков
Обработка выполнена.
Выгружено 16823 объектов.
ГП_БП77_Счетчики_ПоказанияВсех_От_26.10.2024.xml

3. Показания счетчиков
Обработка выполнена.
Выгружено 9765 объектов.
ГП_Счетчики_Показания за 26.10.24.xml

4. Выгрузка услуг
Обработка выполнена.
Выгружено 15316 объектов.
ГП_Услуги_БП77.xml

5. Выгрузить здания
Обработка выполнена.
Выгружено 15316 зданий.
ГП_Здания_БП77.xml

6. Выгрузить контрагентов
Обработка выполнена.
Выгружено 40695 контрагентов.
ГП_Контрагенты_БП77.xml

7. Выгрузить договоры
Обработка выполнена.
Выгружено 69529 договоров.
ГП_Договоры_БП77.xml

8. Выгрузить р/с
Обработка выполнена.
Выгружено 7536 расчетных счетов.
ГП_РасчетныеСчета_БП77.xml

9. Выгрузить нормы потребления
Обработка выполнена.
Выгружено 40 групп потребителей.
ГП_ГруппыПотребителей_БП77.xml

10. Выгрузить тарифы абонентов
Обработка выполнена.
Выгружено 15316 тарифов объектов абонентов.
ГП_ТарифыОбъектовАбонентов_БП77.xml


# Загрузка

0.1 Добавить услуги (и номенклатуру):
    - загрузить из файла: КВП_УслугиИНоменклатураДОП.xml

0.2 Добавить модели ПУ:
    - загрузить из файла: УПЖКХ_МоделиПриборовУчета.xml

0.3 Добавляем Водозаборы
Волокно
Зоринский
КЗТЗ

0.4 Добавляем Характеристики объекта
ОДН

0.5. Добавляем Контролеры
Карнаухова Елена Юрьевна
Куприянова Юлия Алексеевна
Мартынова Виктория Олеговна
Набокова Елена Борисовна
Потолова Елена Николаевна 1
Потолова Елена Николаевна 2
Степаненко Диана Игоревна
Айкашева Кристина Владимировна
Кутепова Валентина Ивановна
-----------------------------------------

## Загрузка исходных данных

1. Загрузка Счетчиков (примерно 10 мин)
Загружено 9 765
	1.1 Обновить счетчики - создает новые счетчики из регистра
	1.2 Сопоставить счетчики - для обновления связей регистра

2. Файл 2. ГП_БП77_Счетчики_ПоказанияВсех_От_26.10.2024.xml (примерно 20 мин)
	2.1 Загрузить показания счетчиков - Файл - 2. ГП_БП77_Счетчики_ПоказанияВсех_От_26.10.2024
		загружено 640 290
	2.2 Загрузить историю состояний счетчиков - 2. ГП_БП77_Счетчики_ПоказанияВсех_От_26.10.2024
		загружено 23 309 / 29 302  (это просто Активность счетчика)


3. Загрузить услуги (Файл 3. ГП_Услуги_БП77.xml) (примерно 5 мин)
		- загружено 8 442
	
	3.1 Сопоставить услуги
		- найдено 6 697 л/с


4. Загрузить здания (файл 4. ГП_Здания_БП77.xml) (примерно 5 мин)
		- загружено 15 316
	
	4.1 Сопоставить здания
		- найдено 6 698


5. Загрузить контрагентов (файл 5. ГП_Контрагенты_БП77.xml) (примерно 10 мин)
		- загружено 40 695


6. Загрузить договоры (файл 6. ГП_Договоры_БП77.xml) (примерно 10 мин)
		- загружено 69 529


7. Загрузить р/с (файл 7. ГП_РасчетныеСчета_БП77.xml) (примерно 2 мин)
		- загружено 7 536
		

8. Загрузить нормы потребления (файл 8. ГП_ГруппыПотребителей_БП77.xml) (примерно 2 мин)
		- загружено 40
	8.1 РС.НормыПотребление
		8.1.1 Создать нормы потребления
			- Создано 21 нормы


9. Загрузить тарифы абонентов (файл 9. ГП_ТарифыОбъектовАбонентов_БП77.xml) (примерно 5 мин)
		- загружено 15 316
	9.1 РС.ТарифыОбъектовАбонентов
		9.1.1 Создать виды тарифов потребителей
			- созданно 6
++++++
====================================================

9А. Заполнение номеров договоров

    >>> скрипт: 7___ЗАПОЛНЕНИЕ_НОМЕРОВ_ДОГОВОРОВ_ПО_НАИМЕНОВАНИЮ.xbsl

9Б. Закрытие неактуальных л/с

    >>> скрипт: 15___ЗАКРЫТИЕ_НЕАКТУАЛЬНЫХ_ЛС.xbsl

------
10. РС.Здания (примерно 10 мин)
	10.1 Создать здания
		- создано 1 745 зданий
	10.2 Создать отсутствующие лицевые счета    // !!!!!!!!!!!!!!!!!!!!!!! <<<
		- создано 1 745 л/с
	10.3 Сопоставить здания - (необязательно)
		- обновлено 0
		
	+++ 10.4 Сопоставить услуги (в загрузка счетчиков)

-------
11. РС.Контрагенты (примерно 20 мин)
	11.1 Сопоставить абонентов  // !!!!!!!!!!!!!!!!!!!!!!! <<<
		- сопоставлено 3 711
	11.2 Создать абонентов
		- создано 231
	------
	--- [!!!!! DEL] 11.3 РС.РасчетныеСчета
		--- [!!!!! DEL] 11.3.1 Создать банки
			- Создано 22 банка
		--- [!!!!! DEL] 11.3.2 Создать банковские счета
			- Создано 270 счета
	------
	
	------
	11.4 РС.Договоры   // !!!!!!!!!!!!!!!!!!!!!!! <<<
		11.4.1 Создать основные договоры
			- Создано 231 договоров
        11.4.1А Заполнение номеров договоров
            >>> скрипт: 7___ЗАПОЛНЕНИЕ_НОМЕРОВ_ДОГОВОРОВ_ПО_НАИМЕНОВАНИЮ.xbsl
            >>> скрипт: 9___ЗАПОЛНЕНИЕ_НОМЕРОВ_ДОГОВОРОВ_НЕГАТИВ_ПО_НАИМЕНОВАНИЮ.xbsl

	-----
	--- [!!!!! DEL] 11.5 Создать документы управления сведениями для взаиморасчетов (!!! Установить дату запрета для пользователя Амели в 31.12.2023)
		- создано 1 646
    11.5 До-создание сведений о взаиморасчетов для основных л/с

        >>> скрипт: 5___ДО-СОЗДАНИЕ_ВЗАМИМОРАСЧЕТОВ_ОСНОВНЫХ_ЛС.xbsl
    
-------

12. РС.Здания (примерно 20 мин)
	12.1 Открыть созданные лицевые счета
		- открыто 1 745 создано 1 745
	12.2 Провести открытые л/с


13. Загрузка счетчиков (примерно 20 мин)
	13.1 Создать документы управления услугами - назначение услугами
		- создано 5 документов
	13.1.2 Провести документы Назначения услуг (удалить ошибочные строки)
	
	13.2 Создать документы установки тарифов
		- создано 20 документов
	13.2.1 Провести документы установки тарифов

14. Заполнение установки счетчиков (примерно 10 мин)
	14.1 Установка основных счетчиков л/с (Дата 01.07.2024)
		- 9 536
	14.1.1 Провести документ Установка счетчика
	14.1.2 Провести документ Ввод показаний счетчика (предварительно удалить строки с пустыми услуги)

	14.2 Создание виртуальных счетчиков (!!! Дата Сегодня)
		- создано 1 608 счетчиков
	14.3 Установить виртуальные счетчики (!!! Дата 01.07.2024)
		- установлено 1 608
	14.3.1 - Провести документ установки счета
	
15. Заполнение зависимостей услуг (примерно 5 мин)
	15.1 Заполнить зависимости услуг
		- 8 754 записи в регистр
	15.2 Заполнить зависимости услуг (НВ на ЦСВ)
		- 11 242 записи в регистр

16 РС.НормыПотребление
	16.1 Выполнить назначение норм потребления на л/с
		- назначено 1 405 норм потребления

20. Заполнение регистров
	20.1 Заполнить динамические показатели (дата 01.08.2024)
		- добавлено 8 442 записи регистра

21. РС.ТарифыОбъектовАбонентов
	21.1 Назначит вид тарифов потребителей на л/с
		- создано 8 431 записей в регистр

22. Исправление договоров контрагентов

    >>> скрипт: 1___ИСПРАВЛЕНИЕ_ДУБЛЕЙ_ДОГОВРОВ_1.xbsl

``` bsl
Результат = ГП_МиграцияЛицевыхСчетов.ВыполнитьКорректировкуОткрытыхЛСПоДублямДоговоров();
```

23. Создание блока счетчиков ОИ

``` bsl
    РезультатФункции = Новый Структура("Успех", Истина);

    // Создание счетчиков
    РезультатСозданияСчетчиков = ГП_МиграцияСчетчиковОИ.СоздатьСчетчикиВиртуальныеОИ();
    Если РезультатСозданияСчетчиков.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатСозданияСчетчиков.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнено создание виртуальных счетчиков ОИ");
    КонецЕсли;

    // Установка счетчиков
    РезультатУстановкиСчетчиков = ГП_МиграцияСчетчиковОИ.СоздатьДокументыУстановкиВиртуальныхСчетчиковОИ(
            Дата(2024, 01, 01), Дата(2024, 01, 01));
    Если РезультатУстановкиСчетчиков.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиСчетчиков.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка виртуальных счетчиков ОИ");
    КонецЕсли;

    // Назначение услуг
    РезультатНазначенияУслуг = ГП_МиграцияСчетчиковОИ.СоздатьДокументНазначенияУслугиХВСОИДляВиртуальныхСчетчиков(
            Дата(2024, 01, 01), Дата(2024, 1, 1), Ложь);
    Если РезультатНазначенияУслуг.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатНазначенияУслуг.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнено назначение услуг виртуальных счетчиков ОИ");
    КонецЕсли;

    // Установка зависимости Канализация
    РезультатУстановкиЗависимостей = ГП_МиграцияСчетчиковОИ.ЗаполнитьЗависимостиКанализацииОтУслугОИ(Дата(2024, 01, 01));
    Если РезультатУстановкиЗависимостей.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиЗависимостей.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка зависимости канализации от виртуальных счетчиков ОИ");
    КонецЕсли;

    // Установка Тарифов
    РезультатУстановкиТарифов = ГП_МиграцияСчетчиковОИ.СоздатьДокументыУстановкиТарифовСчетчиковОИ(Дата(2024, 01, 01));
    Если РезультатУстановкиТарифов.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиТарифов.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка тарифов виртуальных счетчиков ОИ");
    КонецЕсли;

    Если РезультатФункции.Успех = Истина Тогда
        ОбщегоНазначения.СообщитьПользователю("УСПЕХ! Блок создания счетчиков ОИ выполнен успешно");
    Иначе
        ОбщегоНазначения.СообщитьПользователю("ВНИМАНИЕ!!! Блок создания счетчиков ОИ не выполнен");
    КонецЕсли;
```

24. Создание блока счетчиков ПОТЕРЬ

``` bsl
    РезультатФункции = Новый Структура("Успех", Истина);

    // Создание счетчиков
    РезультатСозданияСчетчиков = ГП_МиграцияСчетчиковПотериВоды.СоздатьСчетчикиВиртуальныеПотерьВоды();
    Если РезультатСозданияСчетчиков.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатСозданияСчетчиков.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнено создание виртуальных счетчиков потерь воды");
    КонецЕсли;

    // Установка счетчиков
    РезультатУстановкиСчетчиков = ГП_МиграцияСчетчиковПотериВоды.СоздатьДокументыУстановкиВиртуальныхСчетчиковПотерьВоды(
            Дата(2024, 01, 01), Дата(2024, 01, 01));
    Если РезультатУстановкиСчетчиков.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиСчетчиков.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка виртуальных счетчиков потерь воды");
    КонецЕсли;

    // Назначение услуг
    РезультатНазначенияУслуг = ГП_МиграцияСчетчиковПотериВоды.СоздатьДокументНазначенияУслугиПотериВодыДляВиртуальныхСчетчиков(
            Дата(2024, 01, 01), Дата(2024, 01, 01), Истина);
    Если РезультатНазначенияУслуг.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатНазначенияУслуг.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнено назначение услуг виртуальных счетчиков потерь воды");
    КонецЕсли;

    // Установка зависимости Канализация
    РезультатУстановкиЗависимостей = ГП_МиграцияСчетчиковПотериВоды.ЗаполнитьЗависимостиКанализацииОтУслугПотериВоды(Дата(2024, 01, 01),
            ГП_МиграцияОбщегоНазначения.ПолучитьУслугуХолодноеВодоснабжение().Ссылка);
    Если РезультатУстановкиЗависимостей.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиЗависимостей.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка зависимости канализации от виртуальных счетчиков потерь воды");
    КонецЕсли;

    // Установка Тарифов
    РезультатУстановкиТарифов = ГП_МиграцияСчетчиковПотериВоды.СоздатьДокументыУстановкиТарифовСчетчиковПотерьВоды(Дата(2024, 01, 01),
            ГП_МиграцияОбщегоНазначения.ПолучитьУслугуХолодноеВодоснабжение().Ссылка);
    Если РезультатУстановкиТарифов.Успех = Ложь Тогда
        ОбщегоНазначения.СообщитьПользователю(РезультатУстановкиТарифов.ТекстСообщения);
        РезультатФункции.Успех = Ложь;
        Возврат РезультатФункции;
    Иначе
        ОбщегоНазначения.СообщитьПользователю("Выполнена установка тарифов виртуальных счетчиков потерь воды");
    КонецЕсли;

    Если РезультатФункции.Успех = Истина Тогда
        ОбщегоНазначения.СообщитьПользователю("УСПЕХ! Блок создания счетчиков Потерь выполнен успешно");
    Иначе
        ОбщегоНазначения.СообщитьПользователю("ВНИМАНИЕ!!! Блок создания счетчиков Потерь не выполнен");
    КонецЕсли;
```

25. Установка признака ТолькоКанализация для физических счетчиков

    >>> скрипт: 2___УСТАНОВКА_ПРИЗНАКА_КАНАЛИЗАЦИЯ_ФИЗ.СЧЕТЧИКОВ.xbsl


26. Замена зависимостей услуг НВ на Канализация

    >>> скрипт: 3___ЗМЕНА_ЗАВИСИМОСТИ_УСЛУГИ_НВ_УАНАЛИЗАЦИЯ.xbsl

### Блок специальных л/с ОИ
27.1 Создание л/с счетчиков ОИ

    >>> скрипт: 4.1___СОЗДАТЬ_ЛС_СЧЕТЧИКОВ_ОИ.xbsl

27.2 Создание зданий и помещений л/с счетчиков ОИ

    >>> скрипт: 4.2___СОЗДАНИЕ_ЗДАНИЙ_ПОМЕЩЕНИЙ_ЛС_ОИ.xbsl

27.3 Открытие л/с счетчиков ОИ

    >>> скрипт: 4.3___ОТКРЫТИЕ_ЛС_ОИ.xbsl

27.4 Создание документа Сведений для взаиморасчетов л/с счетчиков ОИ

    >>> скрипт: 4.4___СОЗДАНИЕ_ВЗАМИМОРАСЧЕТОВ_ЛС_ОИ.xbsl

27.5 Назначение услуги ХВС ОИ для специальных л/с ОИ

    >>> скрипт: 4.5___НАЗНАЧЕНИЕ_УСЛУГИ_ХВСОИ_СПЕЦИАЛЬНЫХ_ЛС_ОИ.xbsl

27.6 Установка тарифов для специальных л/с ОИ

    >>> скрипт: 4.6___УСТАНОВКА_ТАРИФОВ_ХВСОИ_СПЕЦИАЛЬНЫХ_ЛС_ОИ.xbsl

27.7 Установка счетчиков для специальных л/с ОИ

    >>> скрипт: 4.7___УСТАНОВКА_СЧЕТЧИКОВ_ОИ_СПЕЦИАЛЬНЫХ_ЛС_ОИ.xbsl

--- 28. До-создание сведений о взаиморасчетов для основных л/с (если отсутствуют)  ???? // Выполняется ранее

    >>> скрипт: 5___ДО-СОЗДАНИЕ_ВЗАМИМОРАСЧЕТОВ_ОСНОВНЫХ_ЛС.xbsl

29. Заполнение регистра Истории количества по среднему

    >>> скрипт: 6___ЗАПОЛНЕНИЕ_РЕГИСТРА_ИСТОРИИ_КОЛИЧЕСТВА_ПО_СРЕДНЕМУ.xbsl

30. Заполнение счетов оплат контрагентов

    >>> скрипт: 8___ЗАПОЛНЕНИЕ_СЧЕТОВ_ОПЛАТ_КОНТРАГЕНТОВ.xbsl

31. Заполнение кода МКД л/с

    >>> скрипт: 10___ЗАПОЛНЕНИЕ_КОДА_МКД_ЛИЦЕВЫХ_СЧЕТОВ.xbsl

32. Заполнение заводских номеров счетчиков из комментариев

    >>> скрипт: 11___ЗАПОЛНЕНИЕ_ЗАВОДСКИХ_НОМЕРОВ_СЧЕТЧИКОВ_ИЗ_КОММЕНТАРИЕВ.xbsl

33. Замена пустых водозаборов в дин. показателей на НетВодозабора

    >>> скрипт: 12___ЗАМЕНА_ДИН.ПОКАЗАТЕЛЕЙ_ПУСТЫХ_ВОДОЗАБОРОВ.xbsl

34. Установка зависимостей счетчиков Квадра

    >>> скрипт: 13___УСТАНОВКА_ЗАВИСИМОСТЕЙ_ПУ_КВАДРА.xbsl

35. Ввод начального сальдо взаиморасчетов (в2 из БП77)

    >>> скрипт: 14___ВВОД_НАЧАЛЬНОГО_САЛЬДО_В2_изБП77.xbsl // (из файла ГП_ВзаиморасчетыПоАбонентам_БП77_на05.12.24.xml)

